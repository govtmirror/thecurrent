
(function($){$.fn.flickrfeed=function(userid,tags,options){var defaults={limit:10,header:false,imagesize:'small',titletag:'h4',title:true,date:true};var options=$.extend(defaults,options);return this.each(function(i,e){var $e=$(e);if(!$e.hasClass('flickrFeed'))$e.addClass('flickrFeed');var api='http://api.flickr.com/services/feeds/photos_public.gne?lang=en-us&format=json&jsoncallback=?';if(userid!='')api+='&id='+userid;if(tags!='')api+='&tags='+tags;$.getJSON(api,function(data){_callback(e,data,options);});});};var _callback=function(e,data,options){if(!data){return false;}
var html='';var row='';if(options.header)
var desc=data.description;if(desc=='')desc=data.title;
var rsslink=data.link;
var feeds=data.items;
var count=feeds.length;
if(count>options.limit)count=options.limit;
for(var i=0;i<count;i++){var photo=feeds[i];
html+='<li class="flickrRow '+row+'">';
var photoDate=photo.date_taken.split('T');
var photoDate=photoDate[0].replace('-',"/");
var photoDate=new Date(photoDate).toLocaleDateString();
var link='<div style="overflow:auto;"><a href="'+photo.link+'" style="float:left; width:85px" title="'+photo.title+' (View on Flickr)">';
var src=photo.media.m;
if(options.imagesize=='square')src=src.replace('_m','_s');
if(options.imagesize=='thumbnail')src=src.replace('_m','_t');
if(options.imagesize=='medium')src=src.replace('_m','');
html+='<input type="hidden" class="feedLinkInput" value="'+ rsslink +'" ></input>';
html+=link+'<img src="'+src+'" style="float:left" alt="'+photo.title+'" /></a>';
html+='<strong class="date">'+photoDate+'</strong>';
if(options.title)html+='<a target="_blank" href="'+strip(photo.link)+'">'+strip(photo.title)+'</a></div>';
html+='<div class="shareContainer">';
html+='<a class="share" target="_blank" href="'+generateCorridorShare(data)+'"><div class="shareIcon corridorShare"></div></a>';
html+='<a class="share"  href="mailto:?Subject=Shared From the Current - '+photo.title+'&body='+photo.link+'"><div class="shareIcon mailShare"></div></a>';
html+='<a class="share" href="javascript:void(0);"  ><div class="shareIcon discussShare"></div></a>';
html+='</div></li>';}
$(e).html(html);};})(jQuery);
